# NOREVA

<!-- badges: start -->
[![R >3.5](https://img.shields.io/badge/R-%3E3.5-success.svg)](https://www.r-project.org/) <a href='#devtools'>![installed with devtools](https://img.shields.io/badge/installed%20with-devtools-blueviolet.svg)</a> [![GitHub last
commit](https://img.shields.io/github/last-commit/idrblab/NOREVA)](https://github.com/idrblab/NOREVA/commits/master) [![GitHub commit activity](https://img.shields.io/github/commit-activity/m/idrblab/NOREVA)](https://github.com/idrblab/NOREVA/commits/master) [![GitHub codesize](https://img.shields.io/github/languages/code-size/idrblab/NOREVA)](https://github.com/idrblab/NOREVA/releases) [![GitHub all releases](https://img.shields.io/github/downloads/idrblab/NOREVA/total.svg)](https://github.com/idrblab/NOREVA/releases)
<!-- badges: end -->

The NOREVA package not only enables the pre-processing and assessment of multi-class/time-series metabolomic data but also realize a high-throughput discovery of the well-performing pre-processing workflows. Particularly, five well-established criteria, each with a distinct underlying theory, are integrated to ensure a much more comprehensive evaluation than any single criterion. This study provides guidelines for researchers who will engage in biomarker discovery or other differential profiling “omics” studies with respect selecting the most appropriate preprocessing method for a given dataset.For function descriptions and analysis of sample datasets you can also use “??NOREVA” command in R. NOREVA version 2.1.1 realizes (1) the parallel computing together with memory management and (2) the optimization of I/O efficiency.

## Contents
- [Citations](#Citations)<br>
- [Installation](#installation)<br>
- [Description](#Description)<br>
- [Usage](#Usage)<br>
- [Examples](#Examples)<br>

## Citations
You can cite the `NOREVA` publication as follows:

> **Optimization of metabolomic data processing using NOREVA.**
>
> J. B. Fu, Y. Zhang, Y. X. Wang, H. N. Zhang, J. Liu, J. Tang, Q. X. Yang, H. C. Sun, W. Q. Qiu, Y. H. Ma, Z. R. Li, M. Y. Zheng, F. Zhu*.
>
> _Nature Protocols_. 17(1): 129-151 (2022). doi: [10.1038/s41596-021-00636-9
        
        ](https://www.nature.com/articles/s41596-021-00636-9); PubMed ID: 34952956.


## Installation
[![](https://img.shields.io/badge/source%20package-NOREVA.2.1.1.tar.gz-blue.svg)](https://github.com/idrblab/NOREVA/releases/download/NOREVA.2.1.1/NOREVA.2.1.1.tar.gz)

```R
Method 1. Download the source package of NOREVA.2.1.1.tar.gz and install it
install.packages("NOREVA.2.1.1.tar.gz", repos = NULL, type = "source", INSTALL_opts = "--no-multiarch")

##NOREVA package depends on several packages, which can be installed using the below commands:
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biobase")
BiocManager::install("pcaMethods")
BiocManager::install("multtest")
BiocManager::install("limma")
BiocManager::install("impute")
BiocManager::install("statTarget")
BiocManager::install("ProteoMM")
BiocManager::install("timecourse")
BiocManager::install("ropls")
BiocManager::install("vsn")
BiocManager::install("affy")
devtools::install_github("metabolomicstats/NormalizeMets")
devtools::install_github("fawda123/ggord")
install.packages(c('rJava', 'DiffCorr', 'MetNorm', 'ggsci', 'multiROC', 'dummies', 'ggfortify', 'ggpubr', 'sampling', 'VennDiagram', 'RcmdrMisc', 'reshape2', 'futile.logger', 'data.table', 'tidyverse', 'foreach', 'iterators', 'parallel', 'doSNOW'))

Method 2. Or the development version from GitHub:
install.packages("devtools")
devtools::install_github("idrblab/NOREVA")

##NOREVA package depends on several packages, which can be installed using the below commands:
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biobase")
BiocManager::install("pcaMethods")
BiocManager::install("multtest")
BiocManager::install("limma")
BiocManager::install("impute")
BiocManager::install("statTarget")
BiocManager::install("ProteoMM")
BiocManager::install("timecourse")
BiocManager::install("ropls")
BiocManager::install("vsn")
BiocManager::install("affy")
devtools::install_github("metabolomicstats/NormalizeMets")
devtools::install_github("fawda123/ggord")
```

## Description

`library(NOREVA)`

<font size=5>1. This function enables the preparation and input of peak table which facilitate the subsequent application of other NOREVA functions.</font>

```(r)
PrepareInuputFiles(dataformat, rawdata, label)
```
`dataformat` 
This variable allows the user to specify the FORMAT of their input peak table.<br>
“1” denotes the standardized format of peak table accepted by NOREVA;<br>
“2” denotes the customized format of peak table generated by 12 available software tools.<br>

`rawdata` 
This variable allows the user to indicate the NAME of their input peak table file.

`label` 
This variable allows the user to indicate the NAME of their input label file for time-course/multi-class.

<font size=3>2. This function enables the performance assessment of metabolomic data processing for multi-class dataset (with quality control sample 
but without internal standard) using four criteria, and can scan thousands of processing workflows and rank them based on their performances.</font>

```(r)
normulticlassqcall(fileName, SAalpha="Y", SAbeta="Y", SAgamma="Y")
```

`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`SAalpha` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption alpha represents that all metabolites are assumed to be equally important.<br>

`SAbeta` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption beta represents that the level of metabolite abundance is constant among all samples.<br>

`SAgamma` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption gamma represents that the intensities of the majority of the metabolites are not changed under the studied conditions.<br>

<font size=3>3. This function enables the performance assessment of metabolomic data processing for multi-class dataset (without quality control 
sample and without internal standard) using four independent criteria, and can comprehensively scan thousands of processing workflows and rank 
all these workflows based on their performances (assessed from four different perspectives).</font>

```(r)
normulticlassnoall(fileName, SAalpha="Y", SAbeta="Y", SAgamma="Y")
```

`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`SAalpha` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption alpha represents that all metabolites are assumed to be equally important.<br>

`SAbeta` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption beta represents that the level of metabolite abundance is constant among all samples.<br>

`SAgamma` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption gamma represents that the intensities of the majority of the metabolites are not changed under the studied conditions.<br>

<font size=3>4. This function enables the performance assessment of metabolomic data processing for multi-class dataset (with internal standards but 
without quality control sample) using four criteria, and can scan thousands of processing workflows and rank them based on their performances.</font>

```(r)
normulticlassisall(fileName, IS)
```

`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`IS`
This variable allows the user to indicate the column of IS.<br>
If there is only one IS, the column number of this IS should be listed.<br>
If there are multiple ISs, the column number of all ISs should be listed and separated by comma (,).<br>
For example, the replacement of IS to 2,6,9,n indicates that the metabolites in the 2st, 6th, 9th, and nth columns of in your peak table should be considered as the ISs metabolites.

<font size=3>5. This function enables the performance assessment of metabolomic data processing for the time-course dataset (with quality control 
sample but without internal standard) using four independent criteria, and can comprehensively scan thousands of processing workflows and rank 
all these workflows based on their performances (assessed from four different perspectives).</font>

```(r)
nortimecourseqcall(fileName, SAalpha="Y", SAbeta="Y", SAgamma="Y")
```
`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`SAalpha` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption alpha represents that all metabolites are assumed to be equally important.<br>

`SAbeta` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption beta represents that the level of metabolite abundance is constant among all samples.<br>

`SAgamma` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption gamma represents that the intensities of the majority of the metabolites are not changed under the studied conditions.<br>

<font size=3>6. This function enables the performance assessment of metabolomic data processing for time-course dataset (without quality control 
sample and without internal standard) using four independent criteria, and can comprehensively scan thousands of processing workflows and rank 
all these workflows based on their performances (assessed from four different perspectives).</font>

```(r)
nortimecoursenoall(fileName, SAalpha="Y", SAbeta="Y", SAgamma="Y")
```
`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`SAalpha` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption alpha represents that all metabolites are assumed to be equally important.<br>

`SAbeta` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption beta represents that the level of metabolite abundance is constant among all samples.<br>

`SAgamma` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption gamma represents that the intensities of the majority of the metabolites are not changed under the studied conditions.<br>

<font size=3>7. This function enables the performance assessment of metabolomic data processing for time-course dataset (with internal standards but 
without quality control sample) using four independent criteria, and can comprehensively scan thousands of processing workflows and rank all 
these workflows based on their performances (assessed from four different perspectives).</font>

```(r)
nortimecourseisall(fileName, IS)
```
`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`IS`
This variable allows the user to indicate the column of IS.<br>
If there is only one IS, the column number of this IS should be listed.<br>
If there are multiple ISs, the column number of all ISs should be listed and separated by comma (,).<br>
For example, the replacement of IS to 2,6,9,n indicates that the metabolites in the 2st, 6th, 9th, and nth columns of in your peak table should be considered as the ISs metabolites.

<font size=3>8. This function enables the performance assessment of metabolomic data processing for multi-class dataset (with quality control sample 
but without internal standard) using five independent criteria, and can comprehensively scan thousands of processing workflows and rank all these 
workflows based on their performances.</font>

```(r)
normulticlassqcall(fileName, GS, SAalpha="Y", SAbeta="Y", SAgamma="Y")
```

`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`GS`
The corresponding data of golden standards for performance evaluation using Criterion e. For the detailed information of the correct file format, please use “??NOREVA” and download sample data in the corresponding section “Welcome to Download the Sample Data for Testing and for File Format Correcting”.

`SAalpha` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption alpha represents that all metabolites are assumed to be equally important.<br>

`SAbeta` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption beta represents that the level of metabolite abundance is constant among all samples.<br>

`SAgamma` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption gamma represents that the intensities of the majority of the metabolites are not changed under the studied conditions.<br>

<font size=3>9. This function enables the performance assessment of metabolomic data processing for multi-class dataset (without quality control 
sample and without internal standard) using five criteria, and can scan thousands of workflows and rank them based on their performances.</font>

```(r)
normulticlassnoall(fileName, GS, SAalpha="Y", SAbeta="Y", SAgamma="Y")
```

`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`GS`
The corresponding data of golden standards for performance evaluation using Criterion e. For the detailed information of the correct file format, please use “??NOREVA” and download sample data in the corresponding section “Welcome to Download the Sample Data for Testing and for File Format Correcting”.

`SAalpha` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption alpha represents that all metabolites are assumed to be equally important.<br>

`SAbeta` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption beta represents that the level of metabolite abundance is constant among all samples.<br>

`SAgamma` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption gamma represents that the intensities of the majority of the metabolites are not changed under the studied conditions.<br>

<font size=3>10. This function enables the performance assessment of metabolomic data processing for multi-class dataset (with internal standards but 
without quality control sample) using five criteria, and can scan thousands of processing workflows and rank them based on their performances.</font>

```(r)
normulticlassisall(fileName, IS, GS)
```

`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`GS`
The corresponding data of golden standards for performance evaluation using Criterion e. For the detailed information of the correct file format, please use “??NOREVA” and download sample data in the corresponding section “Welcome to Download the Sample Data for Testing and for File Format Correcting”.

`IS`
This variable allows the user to indicate the column of IS.<br>
If there is only one IS, the column number of this IS should be listed.<br>
If there are multiple ISs, the column number of all ISs should be listed and separated by comma (,).<br>
For example, the replacement of IS to 2,6,9,n indicates that the metabolites in the 2st, 6th, 9th, and nth columns of in your peak table should be considered as the ISs metabolites.

<font size=3>11. This function enables the performance assessment of metabolomic data processing for the time-course dataset (with quality control 
sample but without internal standard) using five criteria, and can scan thousands of workflows and rank them based on their performances.</font>

```(r)
nortimecourseqcallgs(fileName, GS, SAalpha="Y", SAbeta="Y", SAgamma="Y")
```

`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`GS`
The corresponding data of golden standards for performance evaluation using Criterion e. For the detailed information of the correct file format, please use “??NOREVA” and download sample data in the corresponding section “Welcome to Download the Sample Data for Testing and for File Format Correcting”.

`SAalpha` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption alpha represents that all metabolites are assumed to be equally important.<br>

`SAbeta` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption beta represents that the level of metabolite abundance is constant among all samples.<br>

`SAgamma` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption gamma represents that the intensities of the majority of the metabolites are not changed under the studied conditions.<br>

<font size=3>12. This function enables the performance assessment of metabolomic data processing for time-course dataset (without quality control 
sample and without internal standard) using five criteria, and can scan thousands of workflows and rank them based on their performances.</font>

```(r)
nortimecoursenoallgs(fileName, GS, SAalpha="Y", SAbeta="Y", SAgamma="Y")
```
`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`GS`
The corresponding data of golden standards for performance evaluation using Criterion e. For the detailed information of the correct file format, please use “??NOREVA” and download sample data in the corresponding section “Welcome to Download the Sample Data for Testing and for File Format Correcting”.

`SAalpha` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption alpha represents that all metabolites are assumed to be equally important.<br>

`SAbeta` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption beta represents that the level of metabolite abundance is constant among all samples.<br>

`SAgamma` 
This variable allows the user to specify the study assumption of their input peak table.<br>
“Y” denotes the peak table satisfies the study assumption.<br>
“N” denotes the peak table satisfies the study assumption.<br>
Study assumption gamma represents that the intensities of the majority of the metabolites are not changed under the studied conditions.<br>

<font size=3>13. This function enables the performance assessment of metabolomic data processing for time-course dataset (with internal standards but 
without quality control sample) using five criteria, and can scan thousands of processing workflows and rank them based on their performances.</font>

```(r)
nortimecourseisallgs(fileName, IS, GS)
```
`fileName` 
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`IS`
This variable allows the user to indicate the column of IS.<br>
If there is only one IS, the column number of this IS should be listed.<br>
If there are multiple ISs, the column number of all ISs should be listed and separated by comma (,).<br>
For example, the replacement of IS to 2,6,9,n indicates that the metabolites in the 2st, 6th, 9th, and nth columns of in your peak table should be considered as the ISs metabolites.

`GS`
The corresponding data of golden standards for performance evaluation using Criterion e. For the detailed information of the correct file format, please use “??NOREVA” and download sample data in the corresponding section “Welcome to Download the Sample Data for Testing and for File Format Correcting”.

<font size=3>14. This function enables the performance assessment of the processing workflows defined by the preference of NOREVA users based on time-course metabolomic study with dataset with QCSs.</font>

```(r)
nortimecourseqcpart(fileName, selectedMethods)
```

`fileName`
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`selectedMethods`
This variable allows the user to indicate the NAME of the file containing processing workflows defined by the preference of NOREVA users. The file should be in the format of Comma-Separated Values (CSV). Exemplar files are provided by NOREVA and available for download at <a href='https://idrblab.org/noreva2.0/download/all_methods.csv'>here</a>.

<font size=3>15. This function enables the performance assessment of processing workflows defined by the preference of NOREVA users based on time-course metabolomics with ISs.</font>

```(r)
nortimecourseispart(fileName, IS, selectedMethods)
```

`fileName`
This function is used for processing the dataset with internal standards (ISs) of time-course metabolomic study. Sample data of this data type can be downloaded as the following section "Welcome to Download the Sample Data for Testing and for File Format Correcting".

`IS`
Input the Column of Internal Standards. For example, the replacement of IS to 2,6,9,n indicates that the metabolites in the 2st, 6th, 9th, and nth columns of in your input dataset Input-Dataset.csv should be considered as the ISs or quality control metabolites. If there is only one IS, the column number of this IS should be listed. If there are multiple ISs, the column number of all ISs should be listed and separated by comma (,).

`selectedMethods`
This variable allows the user to indicate the NAME of the file containing processing workflows defined by the preference of NOREVA users. The file should be in the format of Comma-Separated Values (CSV). Exemplar files are provided by NOREVA and available for download at <a href='https://idrblab.org/noreva2.0/download/all_methods.csv'>here</a>.

<font size=3>16. This function enables the performance assessment of processing workflows defined by users’ preference based on time-course metabolomics without QCSs and ISs.</font>

```(r)
nortimecoursenopart(fileName, selectedMethods)
```

`fileName`
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`selectedMethods`
This variable allows the user to indicate the NAME of the file containing processing workflows defined by the preference of NOREVA users. The file should be in the format of Comma-Separated Values (CSV). Exemplar files are provided by NOREVA and available for download at <a href='https://idrblab.org/noreva2.0/download/all_methods.csv'>here</a>.

<font size=3>17. This function enables the performance assessment of processing workflows defined by users’ preference based on multi-class (N>1) metabolomic study with dataset with QCSs.</font>

```(r)
normulticlassqcpart(fileName, selectedMethods)
```

`fileName`
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`selectedMethods`
This variable allows the user to indicate the NAME of the file containing processing workflows defined by the preference of NOREVA users. The file should be in the format of Comma-Separated Values (CSV). Exemplar files are provided by NOREVA and available for download at <a href='https://idrblab.org/noreva2.0/download/all_methods.csv'>here</a>.

<font size=3>18. This function enables the performance assessment of processing workflows defined by users’ preference based on multi-class (N>1) metabolomic study with dataset with ISs.</font>

```(r)
normulticlassispart(fileName, IS, selectedMethods)
```

`fileName`
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`IS`
This variable allows the user to indicate the column of IS.<br>
If there is only one IS, the column number of this IS should be listed.<br>
If there are multiple ISs, the column number of all ISs should be listed and separated by comma (,).<br>
For example, the replacement of IS to 2,6,9,n indicates that the metabolites in the 2st, 6th, 9th, and nth columns of in your peak table should be considered as the ISs metabolites.

`selectedMethods`
This variable allows the user to indicate the NAME of the file containing processing workflows defined by the preference of NOREVA users. The file should be in the format of Comma-Separated Values (CSV). Exemplar files are provided by NOREVA and available for download at <a href='https://idrblab.org/noreva2.0/download/all_methods.csv'>here</a>.

<font size=3>19. This function enables the performance assessment of the processing workflows defined by the preference of NOREVA users based on multi-class (N>1) metabolomic study with dataset without QCSs and ISs.</font>

```(r)
seleranks_non <- normulticlassnopart(fileName, selectedMethods)
```

`fileName`
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`selectedMethods`
This variable allows the user to indicate the NAME of the file containing processing workflows defined by the preference of NOREVA users. The file should be in the format of Comma-Separated Values (CSV). Exemplar files are provided by NOREVA and available for download at <a href='https://idrblab.org/noreva2.0/download/all_methods.csv'>here</a>.

<font size=3>20. This function will output a processed peak table of time-course metabolomic study according to the choice of users must provide the processing workflow.</font>

```(r)
nortimecoursematrix(datatype, fileName, IS, impt=NULL, qcsn=NULL, trsf=NULL, nmal=NULL, nmal2=NULL, nmals=NULL)
```

`datatype`
This variable allows the user to specify the Type of their input peak table.<br>
“1” denotes time-course metabolomic study without QCSs and ISs.<br>
“2” denotes time-course metabolomic study with QCSs.<br>
“3” denotes time-course metabolomic study with ISs.

`fileName`
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`IS`
This variable allows the user to indicate the column of IS.<br>
If there is only one IS, the column number of this IS should be listed.<br>
If there are multiple ISs, the column number of all ISs should be listed and separated by comma (,).<br>
For example, the replacement of IS to 2,6,9,n indicates that the metabolites in the 2st, 6th, 9th, and nth columns of in your peak table should be considered as the ISs metabolites.

`impt` 
This variable allows the user to specify the Type of imputation method.<br>
“1” denotes method of column mean imputation.<br>
“2” denotes method of column median imputation.<br>
“3” denotes method of half of the minimum positive value.<br>
“4” denote method of K-nearest neighbor imputation

`qcsn`
Allows the users to specify the NAME of the quality control sample correction method (default = 1).<br>
“1” denotes the method of NWE (Nadaraya-Watson estimator).<br>
“2” denotes the method of LLR (local linear regression).<br>
“3” denotes the method of LPF (local polynomial fits)

`trsf` 
This variable allows the user to specify the Type of transformation method.<br>
“1” denotes method of cube root transformation.<br>
“2” denotes method of log transformation.<br>
“3” denotes none transformation method.

`nmal`
This variable allows the user to specify the Type of normalization method.<br>
“1” denotes none normalization method.<br>
Metabolite-based Normalization:<br>
"2" denotes method of probabilistic quotient normalization.<br>
"3" denotes method of cyclic loess.<br>
"4" denotes method of contrast.<br>
"5" denotes method of quantile.<br>
"6" denotes method of linear baseline.<br>
"7" denotes method of Li-Wong.<br>
"8" denotes method of cubic splines.<br>
"16" denotes method of MS total useful signal.<br>
"17" denotes method of total sum normalization.<br>
"18" denotes method of median normalization.<br>
"19" denotes method of mean normalization.<br>
"20" denotes method of EigenMS.<br>
Sample-based Normalization:
"9" denotes method of auto scaling.<br>
"10" denotes method of range scaling.<br>
"11" denotes method of pareto scaling.<br>
"12" denotes method of vast scaling.<br>
"13" denotes method of level scaling.<br>
"15" denotes method of power scaling.<br>
Sample & Metabolite-based Normalization:<br>
"14" denotes method of variance stabilization normalization.

`nmal2`
This variable allows the user to specify the Type of normalization method. According to the normalization methods of combination strategy, if you choose sample-based normalization methods for argument “nmal”, “nmal2” should select metabolite-based normalization methods. Similarly, if you choose metabolite-based normalization methods for argument “nmal”, “nmal2” should select sample-based normalization methods. The VSN method you selected is a sample & metabolite-based normalization, which should be applied alone to remove the unwanted signal variations.

`nmals`
This variable allows the user to specify the Type of IS-based normalization method.<br>
“1” denotes method of Single Internal Standard.<br>
“2” denotes method of Normalization using Optimal Selection of Multiple ISs.<br>
“3” denotes method of Cross-contribution Compensating Multi-ISs Normalization.<br>
“4” denotes method of Remove Unwanted Variation-Random.

<font size=3>21. This function will output a processed peak table of multi-class metabolomic study according to the choice of users must provide the processing workflow.</font>

```(r)
normulticlassmatrix(datatype, fileName, IS, impt=NULL, qcsn=NULL, trsf=NULL, nmal=NULL, nmal2=NULL, nmals=NULL)
```
`datatype`
Input the number of data type.<br>
If set 1, the dataset of multi-class (N>1) metabolomic study without QCSs and ISs.<br>
If set 2, the dataset of multi-class (N>1) metabolomic study with QC samples (QCSs).<br>
If set 3, the dataset of multi-class (N>1) metabolomic study with dataset with (ISs).

`fileName`
This variable allows the user to indicate the NAME of result obtained from PrepareInuputFiles function.

`IS`
This variable allows the user to indicate the column of IS.<br>
If there is only one IS, the column number of this IS should be listed.<br>
If there are multiple ISs, the column number of all ISs should be listed and separated by comma (,).<br>
For example, the replacement of IS to 2,6,9,n indicates that the metabolites in the 2st, 6th, 9th, and nth columns of in your peak table should be considered as the ISs metabolites.

`impt` 
This variable allows the user to specify the Type of imputation method.<br>
“1” denotes method of column mean imputation.<br>
“2” denotes method of column median imputation.<br>
“3” denotes method of half of the minimum positive value.<br>
“4” denote method of K-nearest neighbor imputation

`qcsn`
Allows the users to specify the NAME of the quality control sample correction method (default = 1).<br>
“1” denotes the method of NWE (Nadaraya-Watson estimator).<br>
“2” denotes the method of LLR (local linear regression).<br>
“3” denotes the method of LPF (local polynomial fits)

`trsf` 
This variable allows the user to specify the Type of transformation method.<br>
“1” denotes method of cube root transformation.<br>
“2” denotes method of log transformation.<br>
“3” denotes none transformation method.

`nmal`
This variable allows the user to specify the Type of normalization method.<br>
“1” denotes none normalization method.<br>
Metabolite-based Normalization:<br>
"2" denotes method of probabilistic quotient normalization.<br>
"3" denotes method of cyclic loess.<br>
"4" denotes method of contrast.<br>
"5" denotes method of quantile.<br>
"6" denotes method of linear baseline.<br>
"7" denotes method of Li-Wong.<br>
"8" denotes method of cubic splines.<br>
"16" denotes method of MS total useful signal.<br>
"17" denotes method of total sum normalization.<br>
"18" denotes method of median normalization.<br>
"19" denotes method of mean normalization.<br>
"20" denotes method of EigenMS.<br>
Sample-based Normalization:
"9" denotes method of auto scaling.<br>
"10" denotes method of range scaling.<br>
"11" denotes method of pareto scaling.<br>
"12" denotes method of vast scaling.<br>
"13" denotes method of level scaling.<br>
"15" denotes method of power scaling.<br>
Sample & Metabolite-based Normalization:<br>
"14" denotes method of variance stabilization normalization.

`nmal2`
This variable allows the user to specify the Type of normalization method. According to the normalization methods of combination strategy, if you choose sample-based normalization methods for argument “nmal”, “nmal2” should select metabolite-based normalization methods. Similarly, if you choose metabolite-based normalization methods for argument “nmal”, “nmal2” should select sample-based normalization methods. The VSN method you selected is a sample & metabolite-based normalization, which should be applied alone to remove the unwanted signal variations.

`nmals`
This variable allows the user to specify the Type of IS-based normalization method.<br>
“1” denotes method of Single Internal Standard.<br>
“2” denotes method of Normalization using Optimal Selection of Multiple ISs.<br>
“3” denotes method of Cross-contribution Compensating Multi-ISs Normalization.<br>
“4” denotes method of Remove Unwanted Variation-Random.

<font size=3>22. Plot circular barplot of overall ranking results. A circular barplot illustrating the performance level and the overall ranking of all calculatable processing workflows based on the multiple criteria or a single criterion that are selected by user.</font>

```(r)
norvisualization(data, outputfile="NOREVA-Ranking-Top.%d.workflows.%s",cutoff="100", outputtype="pdf", maxValue="40", colorSet = c("#EA4335", "#4285F4", "#FBBC05", "#800080"), totalAngle = "340", bgColor = "#FFFFFF", fontColor="#000000")
```
`data`
This variable allows the user to specify the NAME of the file (.csv) containing the names of processing workflows, their ranking value and representative measurement values under differential criteria, which is obtained from the functions such as the “normulticlassnoall”, “normulticlassqcall”, “nortimecourseqcall”, or “nortimecoursenoall” et al.

`outputfile`
This variable allows the user to specify the NAME of the output file. A format string containing the cutoff value and data type to generate formatted file name.

`cutoff`
This variable allows the user to specify the cutoff value. Integer for the number of strategies ranking at the top of the list, which is used to filter the results. Integer, which means to filter the results, the default is 100.

`outputtype`
String, indicating the output type, support pdf, eps, default is pdf.

`maxValue`
Double-precision floating-point number, representing the characteristic value represented by the maximum length of the rectangle, the default is 40.

`colorSet`
Hexadecimal color string group, representing the four-layer color setting of the graphics from the inside to the outside, the default is red (#EA4335), blue (#4285F4), yellow (#FBBC05), purple (#800080).

`totalAngle`
Double-precision floating-point number, representing the total angle of rotation of the drawing, in degrees, the default value is 340.

`bgColor`
Hexadecimal color string, representing the background color of the graphic drawing, the default is white (#FFFFFF).

`fontColor`
Hexadecimal color string, representing the font color, the default is black (#000000).

## Usage
### Welcome to Download the Sample Data for Testing and for File Format Correcting
```(r)
# Time-course Metabolomic Study
```
Dataset with quality control samples (QCSs) could be <a href='https://idrblab.org/noreva2.0/download/Timecourse_with_QCS.csv'>downloaded</a> and the corresponding data of golden standards for performance evaluation using Criterion e could be <a href='https://idrblab.org/noreva2.0/download/Timecourse_with_QCS_GoldenStandard.csv'>downloaded</a>.

Dataset with internal standards (ISs) could be <a href='https://idrblab.org/noreva2.0/download/Timecourse_with_IS.csv'>downloaded</a> and the corresponding data of golden standards for performance evaluation using Criterion e could be <a href='https://idrblab.org/noreva2.0/download/Timecourse_with_IS_GoldenStandard.csv'>downloaded</a>.

Dataset without QCSs and ISs could be <a href='https://idrblab.org/noreva2.0/download/Timecourse_without_QCSIS.csv'>downloaded</a> and the corresponding data of golden standards for performance evaluation using Criterion e could be <a href='https://idrblab.org/noreva2.0/download/Timecourse_without_QCSIS_GoldenStandard.csv'>downloaded</a>.
```(r)
# Multi-class Metabolomic Study
```
Dataset with quality control samples (QCSs) could be <a href='https://idrblab.org/noreva2.0/download/Multiclass_with_QCS.csv'>downloaded</a> and the corresponding data of golden standards for performance evaluation using Criterion e could be <a href='https://idrblab.org/noreva2.0/download/Multiclass_with_QCS_GoldenStandard.csv'>downloaded</a>.

Dataset with internal standards (ISs) could be <a href='https://idrblab.org/noreva2.0/download/Multiclass_with_IS.csv'>downloaded</a> and the corresponding data of golden standards for performance evaluation using Criterion e could be <a href='https://idrblab.org/noreva2.0/download/Multiclass_with_IS_GoldenStandard.csv'>downloaded</a>.

Dataset without QCSs and ISs could be <a href='https://idrblab.org/noreva2.0/download/Multiclass_without_QCSIS.csv'>downloaded</a> and the corresponding data of golden standards for performance evaluation using Criterion e could be <a href='https://idrblab.org/noreva2.0/download/Multiclass_without_QCSIS_GoldenStandard.csv'>downloaded</a>.

### Sequential step for the performance assessment of time-course metabolomic study with dataset with QCSs. For other types of study, replace the function related to the types.
```(r)
Step 1: time_qcs_data <- PrepareInuputFiles(dataformat = 1, rawdata = "Timecourse-XXX.csv")
Step 2: nortimecourseqcall(fileName = time_qcs_data, SAalpha="Y", SAbeta="Y", SAgamma="Y")
Step 3: norvisualization(data = "OUTPUT-NOREVA-Overall.Ranking.Data.csv", cutoff = "100")
```

### Sequential step for the performance assessment of time-course metabolomic study with dataset with QCSs. For other types of study, replace the function related to the types.
```(r)
Step 1: multi_qcs_data <- PrepareInuputFiles(dataformat = 1, rawdata = "Multiclass-XXX.csv")
Step 2: normulticlassqcall(fileName = multi_qcs_data, SAalpha="Y", SAbeta="Y", SAgamma="Y")
Step 3: norvisualization(data = "OUTPUT-NOREVA-Overall.Ranking.Data.csv", cutoff = "100")
```
## Examples
### Step 1: Prepare input of peak table for assessing processing workflows for metabolomic data
```(r)
multi_qcs_data <- PrepareInuputFiles(dataformat = 1, rawdata = "Multiclass_with_QCS.csv")
```
Note: the file should be in the format of Comma-Separated Values (CSV), which provides the intensity data of metablites. Different functions require different data types. Please refer to the corresponding section "Welcome to Download the Sample Data for Testing and for File Format Correcting" above.

### Step 2: Assessing all processing workflows for multi-class metabolomic data

Multi-class (N>1) Metabolomic Study with dataset with Quality Control Samples (QCSs)
```(r)
normulticlassqcall(fileName = multi_qcs_data, SAalpha="Y", SAbeta="Y", SAgamma="Y")
```
![Alt text1](https://raw.githubusercontent.com/idrblab/NOREVA/main/vignettes/sampledata/NOREVA-Output-All-Criteria-Figures.png)

```{r kable2}
allrankings <- read.csv(file = "./sampledata/OUTPUT-NOREVA-Overall.Ranking.Data.csv",header = T)
head(allrankings)
```

### Step 3: a circular barplot illustrating the performance ranking of all processing workflows

```(r)
norvisualization(data = "OUTPUT-NOREVA-Overall.Ranking.Data.csv", cutoff = "100")
```

Comprehensive assessment among all processing workflows (the top-100 were shown).
![Alt text](https://raw.githubusercontent.com/idrblab/NOREVA/main/vignettes/sampledata/NOREVA-Ranking-Top.100.workflows.png)

### Step 4: Processing datasets using the processing workflows based on the results of assessment

Process the datasets of multi-class (N>1) metabolomic study
```(r)
nordata <- normulticlassmatrix(datatype = 2, fileName = multi_qcs_data, impt=3, qcsn =1, trsf=1, nmal=17, nmal2=13)
```
Note: please select the appropriate number code represents imputation, qc sample correction, transformation, normalization methods (See above details).

### Step 5: Users can also use NOREVA for accessing the part of processing workflows which you preferred

Multi-class (N>1) Metabolomic Study with dataset with Quality Control Samples (QCSs)
```(r)
normulticlassqcpart(fileName = multi_qcs_data, selectedMethods = "selectedMethods.csv")
```
Note: please select the appropriate number code represents imputation, qc sample correction, transformation, normalization methods (See above details).

Should you have any questions, please contact Jianbo Fu at fujianbo@zju.edu.cn
